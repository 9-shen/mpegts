<!DOCTYPE html>
<html>
<head>
    <title>MPEG-TS Parser demo</title>
    <script src="/jDataView/src/jdataview.js"></script>
    <script src="/jBinary/src/jbinary.js"></script>
    <script src="mpegts.js"></script>
    <style type="text/css">
        #jsonContainer { color: #733; font-style: italic; word-wrap: break-word; }
        .jsonValue { color: #373; font-weight: bold; font-style: normal; }
    </style>
</head>
<body>
    <pre id="jsonContainer">
    </pre>
    <script>
        var mpegts = MPEGTS.readFrom('sample.ts', function () {
            // PAT + PMT + ...
            for (var i = 0; i < 3; i++) this.readPacket();

            document.getElementById('jsonContainer').innerHTML = // PES
                JSON.stringify(
                    this.readPacket(),
                    function (key, value) {
                        // if (key[0] === '_') return undefined;

                        if (value instanceof Array && (typeof value[0] === 'number')) {
                            value = value.map(function (value) {
                                var str = value.toString(16).toUpperCase();
                                return str.length == 2 ? str : '0' + str;
                            }).join(' ');
                        }

                        return value instanceof Object ? value : '<span class=jsonValue>' + value + '</span>';
                    },
                    '    '
                );
        });
    </script>
</body>
</html>
